# 대규모 트래픽으로 인한 서버 과부하 해결 방법

### 1. 모니터링
모니터링을 하면 서버 과부하에 대한 대처를 할 수 있다. "어떤 페이지에 어떤 트래픽이 얼마나 발생했나" 혹은 "어떤 네트워크에서 병목현상이 일어났나" 등 모니터링을 통해 알 수 있다. 또한 Slack 같은 협업 툴과 연동해서 설정한 임계치를 기반으로 알림 서비스를 통해 서버 과부하를 예방할 수 있다. 대표적으로 AWS CloudWatch, Netdata, Prometheus 등이 있다. 

</br>

### 2. 로드밸런서
로드밸런서란 서버에 가해지는 트래픽을 여러 대의 서버에게 균등하게 분산시켜주는 역할을 하는 장치를 뜻한다. 또한 로드밸러서는 한 서버에 장애가 발생하면 트래픽을 다른 서버로 리다이렉션하여 시스템 중단을 방지할 수도 있다.

</br>

### 3. 서킷 브레이커
외부 서비스에 의한 문제를 방지하기 위해 등장한 것이 서킷 브레이커이다. 서킷 브레이커는 문제가 발생한 지점을 감지하고 실패하는 요청을 계속하지 않도록 방지한다. 이를 통해 시스템의 장애 확산을 막고, 장애 복구를 도와주며 사용자는 불필요하게 대기하지 않게 된다. 즉, 서킷 브레이커 패턴은 클라이언트 측면에서 장애를 방지하기 위한 도구로써, 실패할 수 있는 작업을 계속 시도하지 않도록 방지한다. Msa 환경에서 많이 사용한다고 한다.

</br>

### 4. 컨텐츠 관리

1. 쿼리 개선 : 인덱스 추가, `select *` 지양 등을 통해 서버 부하를 감소시킬 수 있다. 

2. CDN을 통한 컨텐츠 제공 : CDN을 통해 사용자 가까이, 그리고 분산된 대규모 서버 네트워크를 기반으로 컨텐츠를 제공해서 메인 서버에 대한 부하를 줄일 수 있다.

3. 컨텐츠 캐싱 : 네트워크 트래픽을 해결하는 가장 좋은 방법은 해당 트래픽이 발생하지 않도록 하는 것이다. 브라우저 캐시(쿠키, 로컬 저장소, 세션 저장소)를 통해 해당 요청에 관한 항목을 캐시에서 응답을 읽어 네트워크 요청에 관한 비용을 제거할 수 있다.

4. 컨텐츠 압축 : 텍스트 기반 리소스는 gzip 또는 Brotli를 통해 압축해야 한다. 압축하면 70% 정도까지 압축할 수 있다. 다만 압축했기 때문에 압축을 풀기 위해 서버에서 자원(CPU)을 사용하는 양까지 고려해야 하는데 보통은 압축하면 좋다. 
